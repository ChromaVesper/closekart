import{c as I,r as a,j as e,g as U,u as $,h as D,U as E,n as A,H as b,o as O}from"./index-CA6ijpuF.js";import{L as T}from"./loader-CzdKrhQ5.js";import{C as M}from"./camera-DE7H7sM_.js";import{S as R}from"./save-B_s0e4TY.js";import{P as B}from"./phone-Dgup_HNe.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=I("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),F=({currentAvatar:t,onUpload:g})=>{const m=a.useRef(null),[r,h]=a.useState(!1),i=async l=>{const u=l.target.files[0];if(!u)return;h(!0);const p=new FormData;p.append("avatar",u);try{const x=localStorage.getItem("token"),o=await fetch("https://closekart.onrender.com/api/upload/avatar",{method:"POST",headers:{Authorization:`Bearer ${x}`},body:p});if(o.ok){const f=await o.json();g&&g(f.avatar)}}catch(x){console.error("Upload error:",x)}h(!1)};return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-lg overflow-hidden bg-gray-100 flex items-center justify-center",children:t?e.jsx("img",{src:t,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-blue-100 flex items-center justify-center text-blue-600 text-2xl font-bold",children:"?"})}),e.jsx("button",{onClick:()=>{var l;return(l=m.current)==null?void 0:l.click()},disabled:r,className:"absolute bottom-0 right-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-md hover:bg-blue-700 transition border-2 border-white",children:r?e.jsx(T,{size:14,className:"animate-spin"}):e.jsx(M,{size:14})}),e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:i,className:"hidden"})]})},j="https://closekart.onrender.com/api",K=()=>{const{user:t,logout:g}=U(),m=$(),[r,h]=a.useState(!1),[i,l]=a.useState({name:"",phone:""}),[u,p]=a.useState([]),[x,y]=a.useState([]),[o,f]=a.useState("profile"),[N,v]=a.useState(!1),[w,k]=a.useState(!0);a.useEffect(()=>{if(!t){m("/login");return}l({name:t.name||"",phone:t.phone||""}),P()},[t]);const P=async()=>{k(!0);const s=localStorage.getItem("token");if(!s)return;const c={Authorization:`Bearer ${s}`};try{const[d,S]=await Promise.all([fetch(`${j}/profile/orders`,{headers:c}),fetch(`${j}/profile/wishlist`,{headers:c})]);if(d.ok){const n=await d.json();p(Array.isArray(n)?n:[])}if(S.ok){const n=await S.json();y(Array.isArray(n)?n:(n==null?void 0:n.products)||[])}}catch(d){console.error("Profile fetch error:",d)}k(!1)},C=async()=>{v(!0);try{const s=localStorage.getItem("token");(await fetch(`${j}/user/update`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(i)})).ok&&(h(!1),window.location.reload())}catch(s){console.error(s)}v(!1)},L=()=>{g(),m("/login")};return t?e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden mb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 h-32"}),e.jsx("div",{className:"px-8 pb-6 -mt-12",children:e.jsxs("div",{className:"flex items-end space-x-6",children:[e.jsx(F,{currentAvatar:t.avatar,onUpload:()=>window.location.reload()}),e.jsxs("div",{className:"flex-1 pt-14",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name||"CloseKart User"}),e.jsx("p",{className:"text-gray-500 text-sm",children:t.email||t.phone||""})]}),e.jsxs("button",{onClick:()=>m("/edit-profile"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition font-medium mt-14 mr-2",children:[e.jsx(z,{size:16}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:L,className:"flex items-center space-x-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition font-medium mt-14",children:[e.jsx(D,{size:16}),e.jsx("span",{children:"Logout"})]})]})})]}),e.jsx("div",{className:"flex space-x-1 bg-white rounded-xl shadow-sm p-1 mb-6",children:[{key:"profile",label:"Profile",icon:E},{key:"orders",label:"Orders",icon:A},{key:"wishlist",label:"Wishlist",icon:b}].map(s=>e.jsxs("button",{onClick:()=>f(s.key),className:`flex-1 flex items-center justify-center space-x-2 py-3 rounded-lg font-medium transition ${o===s.key?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(s.icon,{size:18}),e.jsx("span",{children:s.label})]},s.key))}),o==="profile"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Personal Information"}),e.jsxs("button",{onClick:()=>r?C():h(!0),disabled:N,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:[r?e.jsx(R,{size:16}):e.jsx(z,{size:16}),e.jsx("span",{children:r?N?"Saving...":"Save":"Edit"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Full Name"}),r?e.jsx("input",{type:"text",value:i.name,onChange:s=>l({...i,name:s.target.value}),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500 outline-none"}):e.jsx("p",{className:"text-lg text-gray-900 font-medium",children:t.name||"—"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Email"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{size:16,className:"text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-900",children:t.email||"—"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Phone"}),r?e.jsx("input",{type:"tel",value:i.phone,onChange:s=>l({...i,phone:s.target.value}),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500 outline-none"}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{size:16,className:"text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-900",children:t.phone||"—"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Account Type"}),e.jsx("p",{className:"text-lg text-gray-900 capitalize",children:t.provider||"local"})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-100",children:e.jsxs("p",{className:"text-sm text-gray-400",children:["Member since ",t.createdAt?new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"—"]})})]}),o==="orders"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"My Orders"}),w?e.jsx("p",{className:"text-center text-gray-400 py-8",children:"Loading orders..."}):u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No orders yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Start shopping to see your orders here"})]}):e.jsx("div",{className:"space-y-4",children:u.map((s,c)=>{var d;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"font-medium",children:["Order #",(d=s._id)==null?void 0:d.slice(-6)]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full font-medium capitalize",children:s.status||"placed"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():""}),s.totalAmount&&e.jsxs("p",{className:"text-sm font-bold text-green-600 mt-1",children:["₹",s.totalAmount]})]},s._id||c)})})]}),o==="wishlist"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"My Wishlist"}),w?e.jsx("p",{className:"text-center text-gray-400 py-8",children:"Loading wishlist..."}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Your wishlist is empty"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Save items you love for later"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map((s,c)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex items-center space-x-4 hover:shadow-md transition",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover rounded-lg"}):e.jsx(b,{size:24,className:"text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name||"Product"}),e.jsxs("p",{className:"text-sm text-blue-600 font-bold",children:["₹",s.price||"—"]})]})]},c))})]})]}):null};export{K as default};
