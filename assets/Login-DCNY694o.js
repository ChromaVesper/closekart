import{r as s,u as O,g as E,h as d,j as e,R as T,L as y,s as R}from"./index-CzVLudNa.js";import{a as V}from"./authService-DNF6SX3M.js";const G=()=>{const[l,w]=s.useState("email"),[o,v]=s.useState({email:"",password:""}),[i,j]=s.useState(""),[u,m]=s.useState(""),[N,g]=s.useState(!1),[b,c]=s.useState(""),[a,h]=s.useState(!1),x=O(),{loginStore:k}=E();if(!d)return e.jsx("div",{children:"Firebase not initialized"});s.useEffect(()=>{window.recaptchaVerifier||(window.recaptchaVerifier=new T("recaptcha-container",{size:"normal",callback:()=>{}},d))},[]);const f=t=>v({...o,[t.target.name]:t.target.value}),S=async t=>{var r,p;t.preventDefault(),c(""),h(!0);try{const n=await V.login(o.email,o.password);n.token&&(k(n.token,n.user),x("/"))}catch(n){c(((p=(r=n.response)==null?void 0:r.data)==null?void 0:p.msg)||"Login failed")}h(!1)},C=async()=>{try{const t="+91"+i,r=await R(d,t,window.recaptchaVerifier);window.confirmationResult=r,alert("OTP sent successfully"),g(!0)}catch(t){console.error(t),alert(t.message)}},P=async()=>{const r=(await window.confirmationResult.confirm(u)).user;localStorage.setItem("user",JSON.stringify(r)),x("/profile",{replace:!1})},L=[{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"google",label:"Google"}];return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-md border border-gray-100",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6 text-blue-900",children:"Welcome Back"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 rounded-lg p-1 mb-6",children:L.map(t=>e.jsx("button",{onClick:()=>{w(t.key),c("")},className:`flex-1 py-2 rounded-md text-sm font-semibold transition ${l===t.key?"bg-blue-600 text-white shadow":"text-gray-600 hover:text-gray-900"}`,children:t.label},t.key))}),b&&e.jsx("div",{className:"bg-red-100 text-red-600 p-3 rounded mb-4 text-sm font-semibold",children:b}),l==="email"&&e.jsxs("form",{onSubmit:S,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:f,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"you@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:o.password,onChange:f,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"••••••••",required:!0})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition transform active:scale-95 disabled:opacity-50",children:a?"Logging in...":"Login"}),e.jsx("div",{className:"text-center text-sm text-gray-600",children:e.jsx(y,{to:"/forgot-password",className:"text-blue-600 hover:underline",children:"Forgot password?"})})]}),l==="phone"&&e.jsx("div",{className:"space-y-5",children:N?e.jsxs("form",{onSubmit:t=>{t.preventDefault(),P()},className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Enter OTP sent to ",i]}),e.jsx("input",{type:"text",value:u,onChange:t=>m(t.target.value),maxLength:6,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition text-center text-2xl tracking-widest font-mono",placeholder:"000000",required:!0})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:a?"Verifying...":"Verify OTP"}),e.jsx("button",{type:"button",onClick:()=>{g(!1),m("")},className:"w-full text-gray-500 text-sm hover:text-blue-600 transition",children:"Change phone number"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:i,onChange:t=>j(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"+91 9876543210"})]}),e.jsx("button",{onClick:C,disabled:a,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:a?"Sending...":"Send OTP"}),e.jsx("div",{id:"recaptcha-container"})]})}),l==="google"&&e.jsxs("div",{className:"space-y-5",children:[e.jsx("p",{className:"text-center text-gray-500 text-sm mb-4",children:"Sign in securely with your Google account"}),e.jsxs("button",{type:"button",onClick:()=>window.location.href="https://closekart.onrender.com/api/auth/google",className:"w-full flex items-center justify-center bg-white text-gray-700 font-bold py-3 rounded-lg border border-gray-300 hover:bg-gray-50 transition transform active:scale-95 shadow-sm",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google logo",className:"w-5 h-5 mr-3"}),"Continue with Google"]})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:["Don't have an account? ",e.jsx(y,{to:"/register",className:"text-blue-600 font-bold hover:underline",children:"Sign up"})]})]})})};export{G as default};
