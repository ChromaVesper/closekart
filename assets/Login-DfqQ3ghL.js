import{r as s,u as L,g as P,j as e,L as p}from"./index-XVqp2lxo.js";import{a as T}from"./authService-DyvNS2My.js";const G=()=>{const[i,f]=s.useState("email"),[n,y]=s.useState({email:"",password:""}),[c,v]=s.useState(""),[g,m]=s.useState(""),[w,b]=s.useState(!1),[h,d]=s.useState(""),[o,a]=s.useState(!1),j=L(),{loginStore:N}=P(),x=t=>y({...n,[t.target.name]:t.target.value}),k=async t=>{var r,u;t.preventDefault(),d(""),a(!0);try{const l=await T.login(n.email,n.password);l.token&&(N(l.token,l.user),j("/"))}catch(l){d(((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.msg)||"Login failed")}a(!1)},S=async()=>{a(!0),await fetch("https://closekart.onrender.com/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:c})}),b(!0),a(!1)},C=async t=>{t.preventDefault(),a(!0);const r=await fetch("https://closekart.onrender.com/api/auth/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:c,otp:g})});if(r.ok){const u=await r.json();localStorage.setItem("token",u.token),window.location.href="/closekart/"}else d("Verification failed");a(!1)},O=[{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"google",label:"Google"}];return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-md border border-gray-100",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6 text-blue-900",children:"Welcome Back"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 rounded-lg p-1 mb-6",children:O.map(t=>e.jsx("button",{onClick:()=>{f(t.key),d("")},className:`flex-1 py-2 rounded-md text-sm font-semibold transition ${i===t.key?"bg-blue-600 text-white shadow":"text-gray-600 hover:text-gray-900"}`,children:t.label},t.key))}),h&&e.jsx("div",{className:"bg-red-100 text-red-600 p-3 rounded mb-4 text-sm font-semibold",children:h}),i==="email"&&e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:n.email,onChange:x,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"you@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:n.password,onChange:x,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"••••••••",required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition transform active:scale-95 disabled:opacity-50",children:o?"Logging in...":"Login"}),e.jsx("div",{className:"text-center text-sm text-gray-600",children:e.jsx(p,{to:"/forgot-password",className:"text-blue-600 hover:underline",children:"Forgot password?"})})]}),i==="phone"&&e.jsx("div",{className:"space-y-5",children:w?e.jsxs("form",{onSubmit:C,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Enter OTP sent to ",c]}),e.jsx("input",{type:"text",value:g,onChange:t=>m(t.target.value),maxLength:6,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition text-center text-2xl tracking-widest font-mono",placeholder:"000000",required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:o?"Verifying...":"Verify OTP"}),e.jsx("button",{type:"button",onClick:()=>{b(!1),m("")},className:"w-full text-gray-500 text-sm hover:text-blue-600 transition",children:"Change phone number"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:c,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"+91 9876543210"})]}),e.jsx("button",{onClick:S,disabled:o,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:o?"Sending...":"Send OTP"})]})}),i==="google"&&e.jsxs("div",{className:"space-y-5",children:[e.jsx("p",{className:"text-center text-gray-500 text-sm mb-4",children:"Sign in securely with your Google account"}),e.jsxs("button",{type:"button",onClick:()=>window.location.href="https://closekart.onrender.com/api/auth/google",className:"w-full flex items-center justify-center bg-white text-gray-700 font-bold py-3 rounded-lg border border-gray-300 hover:bg-gray-50 transition transform active:scale-95 shadow-sm",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google logo",className:"w-5 h-5 mr-3"}),"Continue with Google"]})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:["Don't have an account? ",e.jsx(p,{to:"/register",className:"text-blue-600 font-bold hover:underline",children:"Sign up"})]})]})})};export{G as default};
