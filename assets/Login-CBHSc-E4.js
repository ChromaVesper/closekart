import{r as n,u as C,g as L,j as e,L as v}from"./index-CjyaYRmW.js";import{a as E}from"./authService-BGc9l61N.js";const A=()=>{const[u,w]=n.useState("email"),[d,j]=n.useState({email:"",password:""}),[r,N]=n.useState(""),[g,m]=n.useState(""),[k,b]=n.useState(!1),[h,s]=n.useState(""),[l,i]=n.useState(!1),x=C(),{loginStore:p}=L(),f="https://closekart.onrender.com/api",y=t=>j({...d,[t.target.name]:t.target.value}),S=async t=>{var a,o;t.preventDefault(),s(""),i(!0);try{const c=await E.login(d.email,d.password);c.token&&(p(c.token,c.user),x("/"))}catch(c){s(((o=(a=c.response)==null?void 0:a.data)==null?void 0:o.msg)||"Login failed")}i(!1)},P=async()=>{if(s(""),!r||r.length<10){s("Enter a valid phone number");return}i(!0);try{const t=await fetch(`${f}/auth/send-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:r})}),a=await t.json();t.ok?b(!0):s(a.msg||"Failed to send OTP")}catch{s("Failed to send OTP")}i(!1)},O=async t=>{t.preventDefault(),s(""),i(!0);try{const a=await fetch(`${f}/auth/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:r,otp:g})}),o=await a.json();a.ok&&o.token?(p(o.token,o.user),x("/")):s(o.msg||"Invalid OTP")}catch{s("OTP verification failed")}i(!1)},T=[{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"google",label:"Google"}];return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-md border border-gray-100",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6 text-blue-900",children:"Welcome Back"}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 rounded-lg p-1 mb-6",children:T.map(t=>e.jsx("button",{onClick:()=>{w(t.key),s("")},className:`flex-1 py-2 rounded-md text-sm font-semibold transition ${u===t.key?"bg-blue-600 text-white shadow":"text-gray-600 hover:text-gray-900"}`,children:t.label},t.key))}),h&&e.jsx("div",{className:"bg-red-100 text-red-600 p-3 rounded mb-4 text-sm font-semibold",children:h}),u==="email"&&e.jsxs("form",{onSubmit:S,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:d.email,onChange:y,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"you@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:d.password,onChange:y,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"••••••••",required:!0})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition transform active:scale-95 disabled:opacity-50",children:l?"Logging in...":"Login"}),e.jsx("div",{className:"text-center text-sm text-gray-600",children:e.jsx(v,{to:"/forgot-password",className:"text-blue-600 hover:underline",children:"Forgot password?"})})]}),u==="phone"&&e.jsx("div",{className:"space-y-5",children:k?e.jsxs("form",{onSubmit:O,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Enter OTP sent to ",r]}),e.jsx("input",{type:"text",value:g,onChange:t=>m(t.target.value),maxLength:6,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition text-center text-2xl tracking-widest font-mono",placeholder:"000000",required:!0})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:l?"Verifying...":"Verify OTP"}),e.jsx("button",{type:"button",onClick:()=>{b(!1),m("")},className:"w-full text-gray-500 text-sm hover:text-blue-600 transition",children:"Change phone number"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:r,onChange:t=>N(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"+91 9876543210"})]}),e.jsx("button",{onClick:P,disabled:l,className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition transform active:scale-95 disabled:opacity-50",children:l?"Sending...":"Send OTP"})]})}),u==="google"&&e.jsxs("div",{className:"space-y-5",children:[e.jsx("p",{className:"text-center text-gray-500 text-sm mb-4",children:"Sign in securely with your Google account"}),e.jsxs("button",{type:"button",onClick:()=>window.location.href="https://closekart.onrender.com/api/auth/google",className:"w-full flex items-center justify-center bg-white text-gray-700 font-bold py-3 rounded-lg border border-gray-300 hover:bg-gray-50 transition transform active:scale-95 shadow-sm",children:[e.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google logo",className:"w-5 h-5 mr-3"}),"Continue with Google"]})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:["Don't have an account? ",e.jsx(v,{to:"/register",className:"text-blue-600 font-bold hover:underline",children:"Sign up"})]})]})})};export{A as default};
