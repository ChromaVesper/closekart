import{r as a,j as e,d as f}from"./index-COo9ZMjH.js";const x=()=>{const[l,o]=a.useState([]),[t,n]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const r=await f.get("/shorts");o(r.data)}catch(r){console.error("Error fetching shorts, falling back to dummy data",r),o([{_id:"1",title:"Beautiful sunset at the local beach ðŸŒ… #nature",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",sellerId:{shopName:"Local Explorers"}},{_id:"2",title:"Trying the new spicy ramen from Downtown Noodle! ðŸœðŸ”¥",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",sellerId:{shopName:"Foodie Reviews"}}])}finally{n(!1)}})()},[]),t?e.jsx("div",{className:"flex h-[calc(100vh-64px)] items-center justify-center bg-black",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"})}):l.length===0?e.jsx("div",{className:"flex h-[calc(100vh-64px)] items-center justify-center bg-black text-white",children:e.jsx("p",{children:"No shorts available at the moment."})}):e.jsx("div",{className:"h-[calc(100vh-64px)] w-full bg-black overflow-y-scroll snap-y snap-mandatory hide-scrollbar relative",children:l.map((s,r)=>e.jsx(p,{short:s,autoPlay:r===0},s._id))})},p=({short:l,autoPlay:o})=>{var c;const t=a.useRef(null),[n,s]=a.useState(o),r=()=>{n?(t.current.pause(),s(!1)):(t.current.play(),s(!0))};return a.useEffect(()=>{const d={root:null,rootMargin:"0px",threshold:.6},i=new IntersectionObserver(u=>{u.forEach(h=>{h.isIntersecting?(t.current.play().catch(m=>console.log("Autoplay prevented",m)),s(!0)):(t.current.pause(),s(!1))})},d);return t.current&&i.observe(t.current),()=>{t.current&&i.unobserve(t.current)}},[]),e.jsxs("div",{className:"h-[calc(100vh-64px)] w-full w-full max-w-lg mx-auto snap-start relative bg-black flex justify-center items-center",children:[e.jsx("video",{ref:t,src:l.videoUrl,className:"w-full h-full object-cover cursor-pointer",loop:!0,muted:!1,onClick:r,playsInline:!0}),!n&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none bg-black/20",children:e.jsx("div",{className:"w-16 h-16 bg-black/50 rounded-full flex items-center justify-center text-white backdrop-blur-sm",children:e.jsx("svg",{className:"w-8 h-8 ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})}),e.jsxs("div",{className:"absolute bottom-16 sm:bottom-4 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent text-white pb-safe",children:[e.jsxs("h3",{className:"font-bold text-sm mb-1",children:["@",((c=l.sellerId)==null?void 0:c.shopName)||"User"]}),e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:l.title})]})]})};export{x as default};
