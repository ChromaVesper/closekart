const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ShopMap-Dn34CU0i.js","assets/index-CMn2OCfz.js","assets/index-B3kFhi2N.css","assets/TileLayer-Dmsxmx0a.js"])))=>i.map(i=>d[i]);
import{b as h,r as a,d as j,j as e,M as c,L as f,_ as N}from"./index-CMn2OCfz.js";import{S as m}from"./store-XU6EZbUz.js";import{S as v}from"./sliders-horizontal-CqZ8IVZV.js";import{N as y}from"./navigation-B0oJ5kbR.js";import{L as S}from"./loader-CqrapTO7.js";import{S as w}from"./star-DUyQLcyi.js";const z=a.lazy(()=>N(()=>import("./ShopMap-Dn34CU0i.js"),__vite__mapDeps([0,1,2,3]))),k=[{label:"1 km",value:1e3},{label:"3 km",value:3e3},{label:"5 km",value:5e3},{label:"10 km",value:1e4}],C=()=>{const{activeCoords:t,selectedAddress:l}=h(),[i,p]=a.useState([]),[o,x]=a.useState(!1),[d,u]=a.useState(""),[r,b]=a.useState(5e3),[n,g]=a.useState(!1);return a.useEffect(()=>{t&&(x(!0),u(""),j.get("/shops",{params:{lat:t.latitude,lng:t.longitude,radius:r}}).then(s=>p(s.data)).catch(()=>u("Failed to load nearby shops.")).finally(()=>x(!1)))},[t,r]),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(m,{size:24,className:"text-blue-600"})," Nearby Shops"]}),l&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx(c,{size:13}),l.city||l.fullAddress]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-xl px-3 py-2 text-sm",children:[e.jsx(v,{size:13,className:"text-gray-400"}),e.jsx("select",{value:r,onChange:s=>b(Number(s.target.value)),className:"text-sm font-medium text-gray-700 bg-transparent focus:outline-none cursor-pointer",children:k.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("button",{onClick:()=>g(s=>!s),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-semibold transition border
                            ${n?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-200 hover:border-blue-300"}`,children:[e.jsx(c,{size:14})," ",n?"List":"Map"]})]})]}),!t&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-2xl p-6 text-center",children:[e.jsx(y,{size:32,className:"mx-auto mb-3 text-amber-400"}),e.jsx("p",{className:"font-semibold text-amber-800",children:"No location selected"}),e.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"Click the address chip in the navbar to set your delivery location."})]}),o&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(S,{size:28,className:"animate-spin text-blue-500"})}),d&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 rounded-xl p-4 text-sm",children:d}),!o&&t&&!d&&(n?e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"h-[450px] bg-gray-100 rounded-2xl animate-pulse"}),children:e.jsx(z,{shops:i,userLocation:t,radius:r})}):i.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-400",children:[e.jsx(m,{size:48,className:"mx-auto mb-4 text-gray-200"}),e.jsxs("p",{className:"font-semibold text-gray-500",children:["No shops found within ",r/1e3," km"]}),e.jsx("p",{className:"text-sm mt-1",children:"Try increasing the radius or changing your address."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.map(s=>e.jsx(f,{to:`/shop/${s._id}`,className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-5 hover:shadow-md hover:border-blue-200 transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center shrink-0",children:s.shopImage?e.jsx("img",{src:s.shopImage,alt:s.shopName,className:"w-full h-full object-cover rounded-xl"}):e.jsx(m,{size:22,className:"text-blue-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate",children:s.shopName}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:s.category}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{size:11,className:"text-amber-400"})," ",s.rating]}),s.distanceKm!=null&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(c,{size:11})," ",s.distanceKm.toFixed(1)," km"]}),s.deliveryAvailable&&e.jsx("span",{className:"text-green-600 font-medium",children:"ðŸ›µ Delivery"})]})]})]})},s._id))}))]})};export{C as default};
