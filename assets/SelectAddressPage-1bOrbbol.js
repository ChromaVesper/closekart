const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MapPicker-27gMlHt6.js","assets/index-BndugRKt.js","assets/index-B3kFhi2N.css","assets/TileLayer-BTZ4TFOX.js","assets/loader-Dw9M15e8.js","assets/x-oHTxqPBv.js","assets/navigation-BYMh_Khn.js","assets/check-CeebbZtv.js"])))=>i.map(i=>d[i]);
import{c as z,M as v,H as q,j as e,r as x,U as Y,S as Z,_ as D,b as R,i as K,u as X}from"./index-BndugRKt.js";import{C as J}from"./check-circle-iuPC4Hmm.js";import{S as Q}from"./star-JiAF4G0N.js";import{P as ee,T as te}from"./trash-2-D6kcOn-b.js";import{L as E}from"./loader-Dw9M15e8.js";import{N as se}from"./navigation-BYMh_Khn.js";import{M as ae}from"./map-COgCjQo2.js";import{P as re}from"./phone-xqznA1Lx.js";import{H as B,B as le}from"./hash-BOFqmQgF.js";import{C as oe}from"./check-CeebbZtv.js";import{X as ne}from"./x-oHTxqPBv.js";import{P as ie}from"./plus-BQCMnQG-.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=z("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=z("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=z("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),ce={Home:q,Work:U,Hotel:V,Other:v},T={Home:"bg-blue-50   text-blue-700  border-blue-200",Work:"bg-indigo-50 text-indigo-700 border-indigo-200",Hotel:"bg-amber-50  text-amber-700 border-amber-200",Other:"bg-gray-50   text-gray-600  border-gray-200"},xe=({address:t,onSelect:i,onEdit:h,onDelete:m,onSetDefault:l,isSelected:r})=>{const s=ce[t.label]||v,g=T[t.label]||T.Other,p=[t.houseNumber&&`#${t.houseNumber}`,t.buildingName,t.floor&&`Fl ${t.floor}`].filter(Boolean).join(", "),f=[t.area,t.landmark&&`Near ${t.landmark}`].filter(Boolean).join(", "),o=[t.city,t.state,t.pincode].filter(Boolean).join(", ");return e.jsxs("div",{onClick:i,className:`relative rounded-2xl border-2 p-4 cursor-pointer transition-all group
                ${r?"border-blue-500 bg-blue-50/60 shadow-sm":"border-gray-100 bg-white hover:border-blue-200 hover:shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 text-xs font-semibold px-2.5 py-1 rounded-full border ${g}`,children:[e.jsx(s,{size:11}),t.label]}),t.isDefault&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-semibold text-green-700 bg-green-50 border border-green-200 px-2 py-0.5 rounded-full",children:[e.jsx(J,{size:10})," Default"]}),r&&!t.isDefault&&e.jsx("span",{className:"ml-auto text-xs font-semibold text-blue-600",children:"Delivering here"})]}),(t.fullName||t.phoneNumber)&&e.jsxs("p",{className:"text-xs font-semibold text-gray-800 mb-1",children:[t.fullName,t.phoneNumber&&` Â· ${t.phoneNumber}`]}),p&&e.jsx("p",{className:"text-sm text-gray-700 font-medium",children:p}),f&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:f}),o&&e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:o}),!p&&!f&&!o&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.fullAddress}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-gray-100",onClick:n=>n.stopPropagation(),children:[!t.isDefault&&e.jsxs("button",{onClick:l,className:"text-xs text-gray-500 hover:text-blue-600 font-medium transition flex items-center gap-1",children:[e.jsx(Q,{size:11})," Set default"]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx("button",{onClick:h,className:"p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition",title:"Edit",children:e.jsx(ee,{size:13})}),e.jsx("button",{onClick:m,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:e.jsx(te,{size:13})})]})]})]})},me=x.lazy(()=>D(()=>import("./MapPicker-27gMlHt6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ue=[{id:"Home",icon:q,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-400"},{id:"Work",icon:U,color:"text-indigo-600",bg:"bg-indigo-50",border:"border-indigo-400"},{id:"Hotel",icon:V,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-400"},{id:"Other",icon:v,color:"text-gray-600",bg:"bg-gray-50",border:"border-gray-400"}],N=({label:t,required:i,icon:h,value:m,onChange:l,placeholder:r,type:s="text",half:g})=>e.jsxs("div",{className:g?"":"col-span-2",children:[e.jsxs("label",{className:"block text-xs font-semibold text-gray-500 mb-1",children:[t," ",i&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[h&&e.jsx(h,{size:13,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 z-10"}),e.jsx("input",{type:s,value:m,onChange:p=>l(p.target.value),placeholder:r,className:`w-full border border-gray-200 rounded-xl py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white transition ${h?"pl-8 pr-3":"px-3"}`})]})]}),be={label:"Home",fullName:"",phoneNumber:"",houseNumber:"",buildingName:"",floor:"",area:"",landmark:"",city:"",state:"",pincode:"",country:"",latitude:null,longitude:null},he=({initialData:t=null,onSave:i,onCancel:h,saving:m=!1,error:l=""})=>{const r=!!t,[s,g]=x.useState(()=>{var c,u,b,j;return t?{label:t.label||"Home",fullName:t.fullName||"",phoneNumber:t.phoneNumber||"",houseNumber:t.houseNumber||"",buildingName:t.buildingName||"",floor:t.floor||"",area:t.area||"",landmark:t.landmark||"",city:t.city||"",state:t.state||"",pincode:t.pincode||"",country:t.country||"",latitude:((u=(c=t.location)==null?void 0:c.coordinates)==null?void 0:u[1])||null,longitude:((j=(b=t.location)==null?void 0:b.coordinates)==null?void 0:j[0])||null}:{...be}}),[p,f]=x.useState(!1),[o,n]=x.useState(!1),[A,C]=x.useState(""),d=c=>u=>g(b=>({...b,[c]:u})),F=()=>{if(!navigator.geolocation){C("Geolocation not supported");return}n(!0),C(""),navigator.geolocation.getCurrentPosition(async({coords:c})=>{const{latitude:u,longitude:b}=c;g(j=>({...j,latitude:u,longitude:b}));try{const y=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${u}&lon=${b}&format=json&addressdetails=1`)).json()).address||{};g(M=>({...M,area:y.suburb||y.neighbourhood||y.village||y.county||"",city:y.city||y.town||y.county||"",state:y.state||"",pincode:y.postcode||"",country:y.country||""}))}catch{}n(!1)},()=>{C("Location permission denied"),n(!1)})},L=({fullAddress:c,latitude:u,longitude:b,label:j})=>{g(k=>({...k,latitude:u,longitude:b,label:j||k.label})),f(!1)},S=()=>{s.houseNumber.trim()&&s.fullName.trim()&&s.phoneNumber.trim()&&(!s.latitude||!s.longitude||i(s))},P=s.houseNumber.trim()&&s.fullName.trim()&&s.phoneNumber.trim()&&s.latitude&&s.longitude;return p?e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{size:18})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Pick exact location"})]}),e.jsx(x.Suspense,{fallback:e.jsx("div",{className:"h-[380px] bg-gray-100 rounded-2xl animate-pulse"}),children:e.jsx(me,{showLabelPicker:!1,saveLabel:"Use this location",initialLat:s.latitude||20.5937,initialLng:s.longitude||78.9629,onCancel:()=>f(!1),onSave:L})})]}):e.jsxs("div",{className:"p-4 space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{size:18})}),e.jsx("h3",{className:"font-bold text-gray-900 text-base",children:r?"Edit Address":"Add New Address"})]}),l&&e.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded-xl px-3 py-2",children:l}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2",children:"Save as"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:ue.map(({id:c,icon:u,color:b,bg:j,border:k})=>e.jsxs("button",{onClick:()=>d("label")(c),className:`flex items-center gap-1.5 px-3 py-2 rounded-xl border-2 text-xs font-semibold transition
                                ${s.label===c?`${j} ${b} ${k}`:"border-gray-100 text-gray-500 hover:border-gray-200"}`,children:[e.jsx(u,{size:12})," ",c]},c))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-500 mb-2",children:["Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),s.latitude&&s.longitude?e.jsxs("div",{className:"flex items-center gap-2 bg-green-50 border border-green-200 rounded-xl px-3 py-2 text-xs text-green-800",children:[e.jsx(v,{size:13,className:"text-green-600 shrink-0"}),e.jsx("span",{className:"flex-1",children:s.area||s.city?`${s.area?s.area+", ":""}${s.city}, ${s.state}`:`${s.latitude.toFixed(5)}, ${s.longitude.toFixed(5)}`}),e.jsx("button",{onClick:()=>f(!0),className:"text-green-700 font-semibold hover:text-green-900 transition text-xs underline",children:"Change"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:F,disabled:o,className:"flex-1 flex items-center justify-center gap-2 border-2 border-dashed border-blue-300 text-blue-600 py-2.5 rounded-xl text-xs font-semibold hover:bg-blue-50 transition",children:[o?e.jsx(E,{size:13,className:"animate-spin"}):e.jsx(se,{size:13}),o?"Detectingâ€¦":"Use GPS"]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex-1 flex items-center justify-center gap-2 border-2 border-dashed border-indigo-300 text-indigo-600 py-2.5 rounded-xl text-xs font-semibold hover:bg-indigo-50 transition",children:[e.jsx(ae,{size:13})," Pick on Map"]})]}),A&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:A})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2",children:"Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"Full Name",required:!0,icon:Y,value:s.fullName,onChange:d("fullName"),placeholder:"Your full name"}),e.jsx(N,{label:"Phone Number",required:!0,icon:re,value:s.phoneNumber,onChange:d("phoneNumber"),placeholder:"+91 98765 43210",type:"tel"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 mb-2",children:"Address Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"House / Flat No.",required:!0,icon:B,value:s.houseNumber,onChange:d("houseNumber"),placeholder:"A-204 / 12B",half:!0}),e.jsx(N,{label:"Building Name",icon:le,value:s.buildingName,onChange:d("buildingName"),placeholder:"Anand Nagar",half:!0}),e.jsx(N,{label:"Floor",icon:de,value:s.floor,onChange:d("floor"),placeholder:"2nd Floor",half:!0}),e.jsx(N,{label:"Area / Locality",icon:v,value:s.area,onChange:d("area"),placeholder:"Koregaon Park",half:!0}),e.jsx(N,{label:"Nearby Landmark",icon:Z,value:s.landmark,onChange:d("landmark"),placeholder:"Near Apollo Hospital"}),e.jsx(N,{label:"City",icon:v,value:s.city,onChange:d("city"),placeholder:"Pune",half:!0}),e.jsx(N,{label:"State",icon:v,value:s.state,onChange:d("state"),placeholder:"Maharashtra",half:!0}),e.jsx(N,{label:"Pincode",icon:B,value:s.pincode,onChange:d("pincode"),placeholder:"411001",type:"tel",half:!0}),e.jsx(N,{label:"Country",icon:v,value:s.country,onChange:d("country"),placeholder:"India",half:!0})]})]}),!P&&e.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Fill in House No., Full Name, Phone and pick a location to save."}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{onClick:h,className:"flex-1 border border-gray-200 text-gray-600 py-3 rounded-xl text-sm font-semibold hover:bg-gray-50 transition",children:"Cancel"}),e.jsxs("button",{onClick:S,disabled:!P||m,className:"flex-1 bg-blue-600 text-white py-3 rounded-xl text-sm font-bold hover:bg-blue-700 disabled:opacity-50 transition flex items-center justify-center gap-2",children:[m?e.jsx(E,{size:15,className:"animate-spin"}):e.jsx(oe,{size:15}),m?"Savingâ€¦":r?"Update Address":"Save Address"]})]})]})},ge=x.lazy(()=>D(()=>import("./MapPicker-27gMlHt6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),w="list",_="form",I="map",pe=({onClose:t,inline:i=!1})=>{const{addressList:m,selectedAddress:l,selectAddress:r,addAddress:s,updateAddress:g,setDefault:p,deleteAddress:f}=R(),[o,n]=x.useState(w),[A,C]=x.useState(null),[d,F]=x.useState(!1),[L,S]=x.useState(""),P=()=>{C(null),S(""),n(_)},c=a=>{C(a),S(""),n(_)},u=x.useCallback(async a=>{{S("Please log in first."),n(w);return}},[A,null,s,g,r,t]),b=x.useCallback(async a=>{{S("Please log in first."),n(w);return}},[null,s,r,t]),j=a=>{r(a),t&&t()},k=async a=>{try{await f(a._id)}catch{}},y=async a=>{try{await p(a._id)}catch{}},M=i?"bg-white rounded-2xl border border-gray-100 shadow-lg":"fixed inset-0 z-[9999] flex items-end sm:items-center justify-center",G=i?"":"w-full max-w-md sm:rounded-2xl bg-white shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",W=i?null:e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),H=e.jsxs("div",{className:i?"bg-white rounded-2xl overflow-hidden":G,children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3.5 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:18,className:"text-blue-500"}),e.jsx("h2",{className:"font-bold text-gray-900 text-base",children:"Choose Delivery Address"})]}),t&&e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-700 p-1 rounded-lg hover:bg-gray-100 transition",children:e.jsx(ne,{size:18})})]}),o===w&&e.jsx("div",{className:"flex border-b border-gray-100",children:[["list","ðŸ“‹ Saved"],["map","ðŸ—ºï¸ Map"]].map(([a,$])=>e.jsx("button",{onClick:()=>n(a),className:`flex-1 py-2.5 text-sm font-semibold transition
                                ${o===a?"text-blue-600 border-b-2 border-blue-600":"text-gray-400 hover:text-gray-600"}`,children:$},a))}),o===I&&e.jsx("div",{className:"flex border-b border-gray-100",children:[["list","ðŸ“‹ Saved"],["map","ðŸ—ºï¸ Map"]].map(([a,$])=>e.jsx("button",{onClick:()=>n(a),className:`flex-1 py-2.5 text-sm font-semibold transition
                                ${o===a?"text-blue-600 border-b-2 border-blue-600":"text-gray-400 hover:text-gray-600"}`,children:$},a))}),e.jsxs("div",{className:"overflow-y-auto max-h-[520px] flex-1",children:[o===w&&e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("button",{onClick:P,className:"w-full flex items-center justify-center gap-2 border-2 border-dashed border-blue-300 text-blue-600 py-3 rounded-2xl text-sm font-semibold hover:bg-blue-50 transition mb-3",children:[e.jsx(ie,{size:16})," Add New Address"]}),m.length===0&&e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx(v,{size:36,className:"mx-auto mb-3 text-gray-200"}),e.jsx("p",{className:"font-semibold text-gray-500",children:"No saved addresses"}),e.jsx("p",{className:"text-xs mt-1",children:"Add your first delivery address above"})]}),m.map(a=>e.jsx(xe,{address:a,isSelected:(l==null?void 0:l._id)===a._id,onSelect:()=>j(a),onEdit:()=>c(a),onDelete:()=>k(a),onSetDefault:()=>y(a)},a._id))]}),o===_&&e.jsx(he,{initialData:A,onSave:u,onCancel:()=>n(w),saving:d,error:L}),o===I&&e.jsxs("div",{className:"p-3",children:[L&&e.jsx("p",{className:"text-xs text-red-500 mb-2",children:L}),e.jsx(x.Suspense,{fallback:e.jsx("div",{className:"h-[420px] bg-gray-100 rounded-2xl flex items-center justify-center",children:e.jsx(E,{size:24,className:"animate-spin text-blue-400"})}),children:e.jsx(ge,{showLabelPicker:!0,onCancel:()=>n(w),onSave:b})})]})]})]});return i?H:e.jsxs("div",{className:M,children:[W,e.jsx("div",{className:"relative z-10 w-full max-w-md mx-4 sm:mx-0",children:H})]})},ze=()=>{const[t]=K(),{selectAddress:i,addAddress:h}=R(),m=X(),l=parseFloat(t.get("lat")),r=parseFloat(t.get("lng")),s=!isNaN(l)&&!isNaN(r),g=async()=>{if(s){try{const o=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${l}&lon=${r}&format=json`)).json()).display_name||`${l}, ${r}`,n=await h({label:"Other",fullAddress:o,latitude:l,longitude:r});i(n)}catch{const p=await h({label:"Other",fullAddress:`${l}, ${r}`,latitude:l,longitude:r});i(p)}m("/")}};return e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center gap-6 text-center px-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-8 max-w-md w-full shadow-sm",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-blue-100 text-blue-600 p-4 rounded-full",children:e.jsx(v,{size:32})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Shared Location"}),s?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:["Someone shared a delivery address with you.",e.jsx("br",{}),"Save it to your address book?"]}),e.jsxs("p",{className:"font-mono text-xs text-gray-400 mb-6 bg-gray-100 rounded-lg px-3 py-2",children:[l.toFixed(5),", ",r.toFixed(5)]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>m("/"),className:"flex-1 border border-gray-300 text-gray-600 py-2.5 rounded-xl font-medium hover:bg-gray-50 transition",children:"Skip"}),e.jsx("button",{onClick:g,className:"flex-1 bg-blue-600 text-white py-2.5 rounded-xl font-semibold hover:bg-blue-700 transition",children:"Save Address"})]})]}):e.jsx("p",{className:"text-red-500 text-sm",children:"Invalid or missing coordinates in the link."})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx(pe,{inline:!0})})]})};export{ze as default};
